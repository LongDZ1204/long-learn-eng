<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Health Mastery V3 - Custom Data</title>
    <style>
        /* CSS STYLES - Giao di·ªán s·∫°ch, t·∫≠p trung */
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #f0f2f5; color: #1c1e21; max-width: 800px; margin: 0 auto; padding: 20px; }
        h1 { color: #1877f2; text-align: center; margin-bottom: 5px; }
        .subtitle { text-align: center; color: #65676b; margin-bottom: 20px; font-size: 0.9em; }
        
        /* Navigation */
        .nav { display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; margin-bottom: 20px; }
        .btn { background: #fff; border: 1px solid #ddd; padding: 10px 20px; border-radius: 20px; cursor: pointer; font-weight: 600; transition: 0.2s; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .btn:hover { background: #e4e6eb; transform: translateY(-1px); }
        .btn.active { background: #1877f2; color: white; border-color: #1877f2; }
        
        /* Main Card */
        .card { background: white; padding: 25px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); text-align: center; display: none; min-height: 300px; }
        .card.active { display: block; }
        
        /* Elements */
        .word-display { font-size: 2.2em; font-weight: 800; color: #333; margin: 20px 0; line-height: 1.2; }
        .phonetic { color: #65676b; font-style: italic; font-size: 1.1em; margin-bottom: 15px; }
        .meaning { font-size: 1.3em; color: #1877f2; margin-top: 10px; font-weight: 500; }
        .category-tag { display: inline-block; padding: 4px 10px; border-radius: 4px; font-size: 0.8em; font-weight: bold; color: white; margin-bottom: 10px; }
        
        /* Inputs & Feedback */
        input[type="text"] { width: 90%; padding: 15px; border: 2px solid #ddd; border-radius: 8px; font-size: 1.1em; margin-bottom: 10px; outline: none; }
        input[type="text"]:focus { border-color: #1877f2; }
        .feedback { margin-top: 15px; padding: 15px; border-radius: 8px; font-weight: bold; text-align: left; line-height: 1.5; }
        .correct { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .incorrect { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        
        /* Micro Button */
        .btn-mic { background: #fa3e3e; color: white; border: none; font-size: 1.5em; width: 70px; height: 70px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 10px auto; cursor: pointer; transition: 0.2s; }
        .btn-mic:hover { transform: scale(1.1); }
        .btn-mic.recording { animation: pulse 1.5s infinite; background: #c00; }
        
        @keyframes pulse { 0% { box-shadow: 0 0 0 0 rgba(255, 0, 0, 0.7); } 70% { box-shadow: 0 0 0 20px rgba(255, 0, 0, 0); } 100% { box-shadow: 0 0 0 0 rgba(255, 0, 0, 0); } }
    </style>
</head>
<body>

    <h1>Health Topic Mastery V3</h1>
    <p class="subtitle">Vocabulary ‚Ä¢ Pronunciation ‚Ä¢ Sentence Structures</p>
    
    <div class="nav">
        <button class="btn active" onclick="setTab('vocab')">1. H·ªçc T·ª´ V·ª±ng</button>
        <button class="btn" onclick="setTab('pronounce')">2. Check Ph√°t √Çm</button>
        <button class="btn" onclick="setTab('writing')">3. Luy·ªán Vi·∫øt C√¢u</button>
        <button class="btn" onclick="setTab('speaking')">4. Luy·ªán Ph·∫£n X·∫°</button>
    </div>

    <div id="vocab" class="card active">
        <h3>Flashcards (Normal & Serious Diseases)</h3>
        <div style="height: 220px; border: 2px dashed #ddd; border-radius: 10px; display: flex; flex-direction: column; justify-content: center; align-items: center; cursor: pointer; margin-bottom: 20px; position: relative;" onclick="flipV()">
            <span id="v-tag" class="category-tag" style="background: #999;">Category</span>
            <div id="v-front" class="word-display">Start</div>
            <div id="v-back" class="meaning" style="display:none;">B·∫Øt ƒë·∫ßu</div>
            <div style="font-size: 0.8em; color: #999; margin-top: 20px;">(Ch·∫°m ƒë·ªÉ l·∫≠t)</div>
        </div>
        
        <div style="display: flex; justify-content: space-between;">
            <button class="btn" onclick="prevV()">‚Üê Quay l·∫°i</button>
            <button class="btn" style="background: #42b72a; color: white; border:none;" onclick="nextV()">T·ª´ ti·∫øp theo ‚Üí</button>
        </div>
    </div>

    <div id="pronounce" class="card">
        <h3>Luy·ªán Ph√°t √Çm (T·ª´ Kh√≥)</h3>
        <p style="color:#666">H·ªá th·ªëng s·∫Ω nghe v√† ch·∫•m ƒëi·ªÉm ph√°t √¢m c·ªßa b·∫°n.</p>
        
        <div class="word-display" id="p-word">Diarrhea</div>
        <div class="phonetic" id="p-ipa">/Àåda…™…ôÀàriÀê…ô/</div>
        <div class="meaning" id="p-meaning">Ti√™u ch·∫£y</div>
        
        <div>
            <button class="btn" onclick="playAudio(pronounceData[state.pIndex].en)">üîä Nghe m·∫´u</button>
        </div>
        
        <button class="btn-mic" id="btn-mic" onclick="toggleRecord()">üéôÔ∏è</button>
        <p id="mic-status">B·∫•m micro ƒë·ªÉ ƒë·ªçc</p>
        
        <div id="p-result" class="feedback" style="display:none;"></div>
        
        <div style="margin-top:20px;">
            <button class="btn" onclick="nextP()">T·ª´ kh√°c >></button>
        </div>
    </div>

    <div id="writing" class="card">
        <h3>X√¢y D·ª±ng C√¢u (Templates)</h3>
        <p id="w-guide" style="font-style: italic; color: #555; font-size: 0.9em; margin-bottom: 10px;">Template...</p>
        <p id="w-vn" style="font-weight: bold; font-size: 1.2em; color: #333; margin-bottom: 15px;">...</p>
        
        <input type="text" id="w-input" placeholder="G√µ c√¢u ti·∫øng Anh ho√†n ch·ªânh..." onkeydown="if(event.key==='Enter') checkW()">
        
        <button class="btn" style="background: #1877f2; color: white; border:none;" onclick="checkW()">Ki·ªÉm tra</button>
        <div id="w-feedback" class="feedback" style="display:none;"></div>
        
        <div style="margin-top: 15px;">
            <button class="btn" onclick="nextW()">C√¢u ti·∫øp theo >></button>
        </div>
    </div>

    <div id="speaking" class="card">
        <h3>M√¥ Ph·ªèng H·ªèi - ƒê√°p</h3>
        <p style="color: #666;">M√°y s·∫Ω ƒë√≥ng vai ng∆∞·ªùi h·ªèi (Interviewer).</p>
        
        <div class="word-display" id="s-q" style="font-size: 1.4em; color: #1877f2; text-align: left;">Question...</div>
        
        <button class="btn" onclick="playAudio(document.getElementById('s-q').innerText)">üîä Nghe C√¢u H·ªèi</button>
        
        <hr style="border: 0; border-top: 1px solid #eee; margin: 20px 0;">
        
        <p style="text-align: left; font-weight: bold;">G·ª£i √Ω tr·∫£ l·ªùi (Template):</p>
        <div id="s-template" style="text-align: left; color: #555; font-style: italic; margin-bottom: 10px;"></div>
        
        <button class="btn" onclick="toggleSAns()">üëÅÔ∏è Xem ƒê√°p √Ån M·∫´u</button>
        <div id="s-a" class="meaning" style="display:none; text-align: left; background: #f7f7f7; padding: 15px; border-radius: 8px; margin-top: 10px; font-size: 1.1em;"></div>
        
        <div style="margin-top:20px;">
            <button class="btn" onclick="nextS()">C√¢u h·ªèi kh√°c >></button>
        </div>
    </div>

    <script>
        // ==========================================
        // DATA KHO - C·∫¨P NH·∫¨T THEO Y√äU C·∫¶U C·ª¶A USER
        // ==========================================
        
        // 1. Full Vocabulary (Normal, Serious, Causes, Solutions)
        const vocabData = [
            // NORMAL
            {en: "Headache", vi: "ƒêau ƒë·∫ßu", tag: "Normal Disease"},
            {en: "Stomachache", vi: "ƒêau b·ª•ng", tag: "Normal Disease"},
            {en: "Backache", vi: "ƒêau l∆∞ng (l·ªói c≈©: back paint)", tag: "Normal Disease"}, // Fixed typo
            {en: "Toothache", vi: "ƒêau rƒÉng", tag: "Normal Disease"},
            {en: "Flu", vi: "C·∫£m c√∫m (Catch a flu)", tag: "Normal Disease"},
            {en: "Fever", vi: "S·ªët", tag: "Normal Disease"},
            {en: "Sore throat", vi: "ƒêau h·ªçng", tag: "Normal Disease"},
            {en: "Sore eyes", vi: "ƒêau m·∫Øt", tag: "Normal Disease"},
            {en: "Cough", vi: "Ho", tag: "Normal Disease"},
            {en: "Runny nose", vi: "S·ªï m≈©i", tag: "Normal Disease"},
            {en: "Diarrhea", vi: "Ti√™u ch·∫£y", tag: "Normal Disease"},
            {en: "Food poisoning", vi: "Ng·ªô ƒë·ªôc th·ª©c ƒÉn", tag: "Normal Disease"},
            
            // SERIOUS
            {en: "Obesity", vi: "B√©o ph√¨ (l·ªói c≈©: obesty)", tag: "Serious Disease"}, // Fixed typo
            {en: "Diabetes", vi: "Ti·ªÉu ƒë∆∞·ªùng", tag: "Serious Disease"},
            {en: "Asthma", vi: "Hen suy·ªÖn", tag: "Serious Disease"},
            {en: "Depression", vi: "Tr·∫ßm c·∫£m", tag: "Serious Disease"},
            {en: "Alzheimer‚Äôs disease", vi: "M·∫•t tr√≠ nh·ªõ", tag: "Serious Disease"},
            {en: "Lung diseases", vi: "B·ªánh ph·ªïi", tag: "Serious Disease"},
            {en: "Kidney diseases", vi: "B·ªánh th·∫≠n (l·ªói c≈©: kedney)", tag: "Serious Disease"}, // Fixed typo
            {en: "Liver diseases", vi: "B·ªánh gan", tag: "Serious Disease"},
            {en: "Heart diseases", vi: "B·ªánh tim m·∫°ch (Cardiovascular)", tag: "Serious Disease"},
            {en: "Cancer", vi: "Ung th∆∞", tag: "Serious Disease"},
            {en: "High blood pressure", vi: "Huy·∫øt √°p cao", tag: "Serious Disease"},
            {en: "Arthritis", vi: "Vi√™m kh·ªõp", tag: "Serious Disease"},
            
            // CAUSES
            {en: "Have a sedentary lifestyle", vi: "L·ªëi s·ªëng th·ª• ƒë·ªông/√≠t v·∫≠n ƒë·ªông", tag: "Cause"},
            {en: "Neglect personal hygiene", vi: "L∆° l√† v·ªá sinh c√° nh√¢n", tag: "Cause"},
            {en: "Overwork muscles", vi: "L√†m vi·ªác qu√° s·ª©c c∆° b·∫Øp", tag: "Cause"},
            {en: "Have poor posture", vi: "T∆∞ th·∫ø x·∫•u (ng·ªìi/ƒëi ƒë·ª©ng)", tag: "Cause"},
            {en: "Not get enough physical exercise", vi: "Kh√¥ng t·∫≠p th·ªÉ d·ª•c ƒë·ªß", tag: "Cause"},
            
            // SOLUTIONS
            {en: "Have a bed rest", vi: "Ngh·ªâ ng∆°i tr√™n gi∆∞·ªùng", tag: "Solution"},
            {en: "Go to the pharmacy", vi: "ƒêi nh√† thu·ªëc", tag: "Solution"},
            {en: "Have an injection", vi: "ƒêi ti√™m/ch√≠ch", tag: "Solution"},
            {en: "Undergo a surgery", vi: "Ph·∫´u thu·∫≠t", tag: "Solution"},
            {en: "Have a blood test", vi: "X√©t nghi·ªám m√°u", tag: "Solution"}
        ];

        // 2. Pronunciation Focus (L·ªçc t·ª´ kh√≥ ph√°t √¢m)
        const pronounceData = [
            {en: "Diarrhea", ipa: "/Àåda…™…ôÀàriÀê…ô/", vi: "Ti√™u ch·∫£y"},
            {en: "Obesity", ipa: "/…ô äÀàbiÀês…ôti/", vi: "B√©o ph√¨"},
            {en: "Asthma", ipa: "/Àà√¶zm…ô/", vi: "Hen suy·ªÖn (√¢m 'th' c√¢m)"},
            {en: "Arthritis", ipa: "/…ëÀêrÀàŒ∏ra…™t…™s/", vi: "Vi√™m kh·ªõp"},
            {en: "Diabetes", ipa: "/Àåda…™…ôÀàbiÀêtiÀêz/", vi: "Ti·ªÉu ƒë∆∞·ªùng"},
            {en: "Alzheimer", ipa: "/Àà√¶lts.ha…™.m…ôr/", vi: "B·ªánh Alzheimer"},
            {en: "Stomachache", ipa: "/Ààst åm…ôk-e…™k/", vi: "ƒêau bao t·ª≠"},
            {en: "Cardiovascular", ipa: "/Àåk…ëÀêrdio äÀàv√¶skj…ôl…ôr/", vi: "Tim m·∫°ch"},
            {en: "Sedentary", ipa: "/Ààsednteri/", vi: "Th·ª• ƒë·ªông"},
            {en: "Hygiene", ipa: "/Ààha…™d íiÀên/", vi: "V·ªá sinh"}
        ];

        // 3. Writing Templates (D·ª±a tr√™n c·∫•u tr√∫c User cung c·∫•p)
        const writingData = [
            {
                guide: "Template: I've often got [DISEASE] when [CAUSE]. [TREATMENT]",
                vi: "T√¥i th∆∞·ªùng b·ªã ho khi t√¥i u·ªëng qu√° nhi·ªÅu n∆∞·ªõc l·∫°nh. T√¥i th∆∞·ªùng ƒëi nh√† thu·ªëc.",
                en: "I've often got a cough when I drink too much cold water. I often go to the pharmacy." // User example
            },
            {
                guide: "Template: Old people have often got [DISEASE] because [REASON]. [TREATMENT]",
                vi: "Ng∆∞·ªùi gi√† th∆∞·ªùng b·ªã vi√™m kh·ªõp v√¨ h·ªç l∆∞·ªùi v·∫≠n ƒë·ªông. H·ªç n√™n ƒëi ti√™m.",
                en: "Old people have often got arthritis because they have a sedentary lifestyle. They should have an injection."
            },
            {
                guide: "Template: I dislike [DISEASE] most because [REASON].",
                vi: "T√¥i gh√©t b·ªánh b√©o ph√¨ nh·∫•t v√¨ n√≥ l√†m t√¥i th·∫•y x·∫•u h·ªï.",
                en: "I dislike obesity most because it makes me feel ashamed."
            },
            {
                guide: "Template: Young people are getting more diseases simply because they [CAUSE].",
                vi: "Ng∆∞·ªùi tr·∫ª m·∫Øc nhi·ªÅu b·ªánh h∆°n ƒë∆°n gi·∫£n v√¨ h·ªç l∆° l√† v·ªá sinh c√° nh√¢n.",
                en: "Young people are getting more diseases simply because they neglect personal hygiene."
            },
            {
                guide: "Template: I think our immune system is getting weaker because we [CAUSE].",
                vi: "T√¥i nghƒ© h·ªá mi·ªÖn d·ªãch ch√∫ng ta ƒëang y·∫øu ƒëi v√¨ ch√∫ng ta kh√¥ng t·∫≠p th·ªÉ d·ª•c ƒë·ªß.",
                en: "I think our immune system is getting weaker because we do not get enough physical exercise."
            }
        ];

        // 4. Speaking Patterns (D·ª±a tr√™n c√¢u h·ªèi User cung c·∫•p)
        const speakingData = [
            {
                q: "What is the disease that you often get?",
                template: "I've often got [DISEASE] when [TIME/CAUSE]. [TREATMENT]",
                a: "I've often got a headache when I work late at night. I usually have a bed rest."
            },
            {
                q: "Why are some young people getting more and more diseases?",
                template: "Young people are getting more diseases simply because they [CAUSE 1, 2 and 3].",
                a: "Young people are getting more diseases simply because they have a sedentary lifestyle, eat fast food, and neglect personal hygiene."
            },
            {
                q: "Do you think people living in big cities are having bad health?",
                template: "I think people living in big cities have bad health mostly because they [CAUSE].",
                a: "I think people living in big cities have bad health mostly because they breath in smoke and live in a polluted environment."
            },
            {
                q: "What diseases can we avoid?",
                template: "We can avoid [DISEASE] by [ACTION V-ING].",
                a: "We can avoid heart diseases by doing exercise on a regular basis."
            },
            {
                q: "Who tends to get more diseases? Why?",
                template: "I think [WHO] tends to get more diseases partly because they [CAUSE].",
                a: "I think office workers tend to get more diseases partly because they have poor posture and sit too much."
            }
        ];

        // ==========================================
        // SYSTEM LOGIC (ENGINE)
        // ==========================================
        let state = { pIndex: 0, vIndex: 0, wIndex: 0, sIndex: 0, recording: false };
        let recognition;

        function setTab(id) {
            document.querySelectorAll('.card').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.nav .btn').forEach(el => el.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            event.target.classList.add('active');
        }
        
        function playAudio(text) {
            let u = new SpeechSynthesisUtterance(text);
            u.lang = 'en-US'; u.rate = 0.9;
            window.speechSynthesis.speak(u);
        }

        // --- VOCAB ---
        function loadV() {
            let d = vocabData[state.vIndex];
            document.getElementById('v-tag').innerText = d.tag;
            document.getElementById('v-tag').style.background = d.tag.includes('Serious') ? '#e74c3c' : (d.tag.includes('Cause') ? '#f39c12' : '#3498db');
            document.getElementById('v-front').innerText = d.en;
            document.getElementById('v-back').innerText = d.vi;
            document.getElementById('v-back').style.display = 'none';
        }
        function flipV() {
            let back = document.getElementById('v-back');
            back.style.display = back.style.display === 'none' ? 'block' : 'none';
        }
        function nextV() { state.vIndex = (state.vIndex + 1) % vocabData.length; loadV(); }
        function prevV() { state.vIndex = (state.vIndex - 1 + vocabData.length) % vocabData.length; loadV(); }

        // --- PRONOUNCE ---
        function toggleRecord() {
            if (!recognition) initVoice();
            if (state.recording) recognition.stop();
            else recognition.start();
        }
        function initVoice() {
            if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
                const SR = window.SpeechRecognition || window.webkitSpeechRecognition;
                recognition = new SR();
                recognition.lang = 'en-US';
                recognition.onstart = () => { 
                    state.recording = true; 
                    document.getElementById('btn-mic').classList.add('recording');
                    document.getElementById('mic-status').innerText = "ƒêang nghe...";
                };
                recognition.onend = () => { 
                    state.recording = false; 
                    document.getElementById('btn-mic').classList.remove('recording');
                    document.getElementById('mic-status').innerText = "B·∫•m ƒë·ªÉ n√≥i";
                };
                recognition.onresult = (e) => {
                    let transcript = e.results[0][0].transcript.toLowerCase();
                    let target = pronounceData[state.pIndex].en.toLowerCase();
                    let box = document.getElementById('p-result');
                    box.style.display = 'block';
                    if (transcript.includes(target)) {
                        box.className = "feedback correct";
                        box.innerHTML = `‚úÖ Tuy·ªát v·ªùi! M√°y nghe: "${transcript}"`;
                    } else {
                        box.className = "feedback incorrect";
                        box.innerHTML = `‚ùå Ch∆∞a chu·∫©n. M√°y nghe: "${transcript}"`;
                    }
                };
            } else { alert("Tr√¨nh duy·ªát kh√¥ng h·ªó tr·ª£ Voice API. D√πng Chrome/Edge nh√©!"); }
        }
        function nextP() { 
            state.pIndex = (state.pIndex + 1) % pronounceData.length; 
            document.getElementById('p-result').style.display='none';
            let d = pronounceData[state.pIndex];
            document.getElementById('p-word').innerText = d.en;
            document.getElementById('p-ipa').innerText = d.ipa;
            document.getElementById('p-meaning').innerText = d.vi;
        }

        // --- WRITING ---
        function loadW() {
            let d = writingData[state.wIndex];
            document.getElementById('w-guide').innerText = d.guide;
            document.getElementById('w-vn').innerText = d.vi;
            document.getElementById('w-input').value = "";
            document.getElementById('w-feedback').style.display = 'none';
        }
        function checkW() {
            let user = document.getElementById('w-input').value.trim().toLowerCase().replace(/[.,]/g, '');
            let correct = writingData[state.wIndex].en.toLowerCase().replace(/[.,]/g, '');
            let box = document.getElementById('w-feedback');
            box.style.display = 'block';
            if (user === correct) {
                box.className = "feedback correct"; box.innerText = "‚úÖ Ch√≠nh x√°c ho√†n to√†n!";
            } else {
                box.className = "feedback incorrect"; box.innerHTML = `‚ùå Sai r·ªìi.<br><b>ƒê√°p √°n:</b> ${writingData[state.wIndex].en}`;
            }
        }
        function nextW() { state.wIndex = (state.wIndex + 1) % writingData.length; loadW(); }

        // --- SPEAKING ---
        function loadS() {
            let d = speakingData[state.sIndex];
            document.getElementById('s-q').innerText = d.q;
            document.getElementById('s-template').innerText = d.template;
            document.getElementById('s-a').innerText = d.a;
            document.getElementById('s-a').style.display = 'none';
        }
        function toggleSAns() {
            let a = document.getElementById('s-a');
            a.style.display = a.style.display === 'none' ? 'block' : 'none';
        }
        function nextS() { state.sIndex = (state.sIndex + 1) % speakingData.length; loadS(); }

        // START
        window.onload = () => { loadV(); nextP(); loadW(); loadS(); };

    </script>
</body>
</html>